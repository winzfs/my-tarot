<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ARCANA TAROT | 78 FULL EDITION</title>
    <style>
        :root { --gold: #e2b857; --bg: #0a0a0c; }
        body { background: var(--bg); color: #eee; font-family: 'Apple SD Gothic Neo', sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; overflow-x: hidden; touch-action: none; }
        h1 { color: var(--gold); font-size: 1.5rem; margin: 15px 0; text-shadow: 0 0 10px rgba(226,184,87,0.5); letter-spacing: 2px; }
        
        /* ê²Œì„ ìº”ë²„ìŠ¤ */
        #game-container {
            width: 95vw; max-width: 500px; height: 350px;
            border: 2px solid var(--gold); border-radius: 20px;
            background: radial-gradient(circle, #1a1a2e 0%, #000 100%);
            position: relative; overflow: hidden;
        }
        canvas { width: 100%; height: 100%; display: block; }

        /* ì¡°ì‘ê¸° */
        #controls { display: grid; grid-template-columns: repeat(3, 70px); gap: 15px; margin: 20px 0; justify-content: center; }
        .btn {
            width: 70px; height: 70px; background: rgba(255,255,255,0.05); border: 2px solid var(--gold);
            border-radius: 50%; color: var(--gold); display: flex; align-items: center; justify-content: center;
            font-size: 1.5rem; user-select: none; -webkit-tap-highlight-color: transparent;
        }
        .btn:active { background: var(--gold); color: #000; }

        /* UI ìŠ¤í…Œì´ì§€ */
        #ui-layer, #tarot-stage { display: none; width: 90%; max-width: 500px; text-align: center; box-sizing: border-box; }
        input { width: 100%; padding: 12px; margin-bottom: 8px; border-radius: 10px; border: 1px solid var(--gold); background: #1a1a1a; color: #fff; }
        .mode-card { background: rgba(226, 184, 87, 0.1); border: 1px solid var(--gold); padding: 20px; border-radius: 15px; margin: 10px 0; cursor: pointer; }

        /* ì¹´ë“œ ë°•ìŠ¤ */
        .cards-box { display: flex; justify-content: center; gap: 8px; flex-wrap: wrap; margin-top: 20px; }
        .card { width: 85px; height: 140px; perspective: 1000px; cursor: pointer; }
        .card-inner { position: relative; width: 100%; height: 100%; transition: 0.8s; transform-style: preserve-3d; }
        .card.flipped .card-inner { transform: rotateY(180deg); }
        .card-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border: 1px solid var(--gold); border-radius: 8px; overflow: hidden; }
        .card-front { background: #1a1a2e; display: flex; align-items: center; justify-content: center; color: var(--gold); font-size: 2rem; }
        .card-back { background: #fff; transform: rotateY(180deg); }
        .card-back img { width: 100%; height: 100%; object-fit: cover; }

        #result-display { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px; border: 1px solid var(--gold); margin-top: 15px; line-height: 1.6; text-align: left; min-height: 50px; }
        .action-btn { background: var(--gold); color: #000; border: none; padding: 15px; border-radius: 30px; font-weight: bold; width: 100%; margin-top: 10px; cursor: pointer; }
    </style>
</head>
<body>

    <h1>ARCANUM TAROT</h1>

    <div id="game-wrapper">
        <div id="game-container"><canvas id="gameCanvas" width="500" height="350"></canvas></div>
        <div id="controls">
            <div style="grid-column:2" class="btn" id="up">â–²</div>
            <div style="grid-column:1" class="btn" id="left">â—€</div>
            <div style="grid-column:2" class="btn" id="down">â–¼</div>
            <div style="grid-column:3" class="btn" id="right">â–¶</div>
        </div>
    </div>

    <div id="ui-layer">
        <input type="text" id="user-name" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
        <input type="text" id="user-q" placeholder="ê³ ë¯¼ì„ ì…ë ¥í•˜ì„¸ìš”">
        <div class="mode-card" onclick="startTarot(1)"><h3>ì˜¤ëŠ˜ì˜ í•œ ì¥</h3></div>
        <div class="mode-card" onclick="startTarot(3)"><h3>ìš´ëª…ì˜ ì„¸ ì¥</h3></div>
    </div>

    <div id="tarot-stage">
        <div class="cards-box" id="cards-box"></div>
        <div id="result-display">ì¹´ë“œë¥¼ ë’¤ì§‘ì–´ í™•ì¸í•˜ì„¸ìš”.</div>
        <button id="ai-btn" class="action-btn" style="display:none;" onclick="interpret()">í•´ì„ ìš”ì²­</button>
        <button class="action-btn" style="background:#444; color:#fff;" onclick="location.reload()">ì²˜ìŒìœ¼ë¡œ</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const p = { x: 80, y: 175, color: "#4cc9f0" };
        const n = { x: 400, y: 175, color: "#e2b857" };
        const keys = {};

        // ì¡°ì‘ ì´ë²¤íŠ¸
        const setup = (id, k) => {
            const el = document.getElementById(id);
            el.addEventListener('touchstart', (e) => { e.preventDefault(); keys[k]=true; });
            el.addEventListener('touchend', (e) => { e.preventDefault(); keys[k]=false; });
            el.addEventListener('mousedown', () => keys[k]=true);
        };
        window.addEventListener('mouseup', () => Object.keys(keys).forEach(k => keys[k]=false));
        setup('up','ArrowUp'); setup('down','ArrowDown'); setup('left','ArrowLeft'); setup('right','ArrowRight');

        // 78ì¥ ì´ë¯¸ì§€ ë°ì´í„° ë² ì´ìŠ¤
        const tarotBase = "https://commons.wikimedia.org/wiki/Special:FilePath/";
        const tarotList = [
            {n:"0. ê´‘ëŒ€", i:"RWS_Tarot_00_Fool.jpg"}, {n:"1. ë§ˆë²•ì‚¬", i:"RWS_Tarot_01_Magician.jpg"}, {n:"2. ì—¬ì‚¬ì œ", i:"RWS_Tarot_02_High_Priestess.jpg"}, {n:"3. ì—¬í™©ì œ", i:"RWS_Tarot_03_Empress.jpg"}, {n:"4. í™©ì œ", i:"RWS_Tarot_04_Emperor.jpg"}, {n:"5. êµí™©", i:"RWS_Tarot_05_Hierophant.jpg"}, {n:"6. ì—°ì¸", i:"RWS_Tarot_06_Lovers.jpg"}, {n:"7. ì „ì°¨", i:"RWS_Tarot_07_Chariot.jpg"}, {n:"8. í˜", i:"RWS_Tarot_08_Strength.jpg"}, {n:"9. ì€ë‘”ì", i:"RWS_Tarot_09_Hermit.jpg"}, {n:"10. ìš´ëª…", i:"RWS_Tarot_10_Wheel_of_Fortune.jpg"}, {n:"11. ì •ì˜", i:"RWS_Tarot_11_Justice.jpg"}, {n:"12. ë§¤ë‹¬ë¦° ì‚¬ëŒ", i:"RWS_Tarot_12_Hanged_Man.jpg"}, {n:"13. ì£½ìŒ", i:"RWS_Tarot_13_Death.jpg"}, {n:"14. ì ˆì œ", i:"RWS_Tarot_14_Temperance.jpg"}, {n:"15. ì•…ë§ˆ", i:"RWS_Tarot_15_Devil.jpg"}, {n:"16. íƒ‘", i:"RWS_Tarot_16_Tower.jpg"}, {n:"17. ë³„", i:"RWS_Tarot_17_Star.jpg"}, {n:"18. ë‹¬", i:"RWS_Tarot_18_Moon.jpg"}, {n:"19. íƒœì–‘", i:"RWS_Tarot_19_Sun.jpg"}, {n:"20. ì‹¬íŒ", i:"RWS_Tarot_20_Judgement.jpg"}, {n:"21. ì„¸ê³„", i:"RWS_Tarot_21_World.jpg"},
            {n:"ì™„ë“œ ì—ì´ìŠ¤", i:"Wands01.jpg"}, {n:"ì™„ë“œ 2", i:"Wands02.jpg"}, {n:"ì™„ë“œ 3", i:"Wands03.jpg"}, {n:"ì™„ë“œ 4", i:"Wands04.jpg"}, {n:"ì™„ë“œ 5", i:"Wands05.jpg"}, {n:"ì™„ë“œ 6", i:"Wands06.jpg"}, {n:"ì™„ë“œ 7", i:"Wands07.jpg"}, {n:"ì™„ë“œ 8", i:"Wands08.jpg"}, {n:"ì™„ë“œ 9", i:"Tarot_Nine_of_Wands.jpg"}, {n:"ì™„ë“œ 10", i:"Wands10.jpg"}, {n:"ì™„ë“œ ì‹œì¢…", i:"Wands11.jpg"}, {n:"ì™„ë“œ ê¸°ì‚¬", i:"Wands12.jpg"}, {n:"ì™„ë“œ í€¸", i:"Wands13.jpg"}, {n:"ì™„ë“œ í‚¹", i:"Wands14.jpg"},
            {n:"ì»µ ì—ì´ìŠ¤", i:"Cups01.jpg"}, {n:"ì»µ 2", i:"Cups02.jpg"}, {n:"ì»µ 3", i:"Cups03.jpg"}, {n:"ì»µ 4", i:"Cups04.jpg"}, {n:"ì»µ 5", i:"Cups05.jpg"}, {n:"ì»µ 6", i:"Cups06.jpg"}, {n:"ì»µ 7", i:"Cups07.jpg"}, {n:"ì»µ 8", i:"Cups08.jpg"}, {n:"ì»µ 9", i:"Cups09.jpg"}, {n:"ì»µ 10", i:"Cups10.jpg"}, {n:"ì»µ ì‹œì¢…", i:"Cups11.jpg"}, {n:"ì»µ ê¸°ì‚¬", i:"Cups12.jpg"}, {n:"ì»µ í€¸", i:"Cups13.jpg"}, {n:"ì»µ í‚¹", i:"Cups14.jpg"},
            {n:"ì†Œë“œ ì—ì´ìŠ¤", i:"Swords01.jpg"}, {n:"ì†Œë“œ 2", i:"Swords02.jpg"}, {n:"ì†Œë“œ 3", i:"Swords03.jpg"}, {n:"ì†Œë“œ 4", i:"Swords04.jpg"}, {n:"ì†Œë“œ 5", i:"Swords05.jpg"}, {n:"ì†Œë“œ 6", i:"Swords06.jpg"}, {n:"ì†Œë“œ 7", i:"Swords07.jpg"}, {n:"ì†Œë“œ 8", i:"Swords08.jpg"}, {n:"ì†Œë“œ 9", i:"Swords09.jpg"}, {n:"ì†Œë“œ 10", i:"Swords10.jpg"}, {n:"ì†Œë“œ ì‹œì¢…", i:"Swords11.jpg"}, {n:"ì†Œë“œ ê¸°ì‚¬", i:"Swords12.jpg"}, {n:"ì†Œë“œ í€¸", i:"Swords13.jpg"}, {n:"ì†Œë“œ í‚¹", i:"Swords14.jpg"},
            {n:"íœíƒ€í´ ì—ì´ìŠ¤", i:"Pents01.jpg"}, {n:"íœíƒ€í´ 2", i:"Pents02.jpg"}, {n:"íœíƒ€í´ 3", i:"Pents03.jpg"}, {n:"íœíƒ€í´ 4", i:"Pents04.jpg"}, {n:"íœíƒ€í´ 5", i:"Pents05.jpg"}, {n:"íœíƒ€í´ 6", i:"Pents06.jpg"}, {n:"íœíƒ€í´ 7", i:"Pents07.jpg"}, {n:"íœíƒ€í´ 8", i:"Pents08.jpg"}, {n:"íœíƒ€í´ 9", i:"Pents09.jpg"}, {n:"íœíƒ€í´ 10", i:"Pents10.jpg"}, {n:"íœíƒ€í´ ì‹œì¢…", i:"Pents11.jpg"}, {n:"íœíƒ€í´ ê¸°ì‚¬", i:"Pents12.jpg"}, {n:"íœíƒ€í´ í€¸", i:"Pents13.jpg"}, {n:"íœíƒ€í´ í‚¹", i:"Pents14.jpg"}
        ];

        function loop() {
            if(keys['ArrowUp'] && p.y > 20) p.y -= 5;
            if(keys['ArrowDown'] && p.y < 330) p.y += 5;
            if(keys['ArrowLeft'] && p.x > 20) p.x -= 5;
            if(keys['ArrowRight'] && p.x < 480) p.x += 5;

            ctx.clearRect(0,0,500,350);
            // ë³„ë¬´ë¦¬
            ctx.fillStyle = "#fff";
            for(let i=0; i<30; i++) ctx.fillRect((i*173)%500, (i*197)%350, 2, 2);

            // NPC (ë§ˆë²•ì‚¬ êµ¬ì²´)
            ctx.fillStyle = n.color; ctx.shadowBlur = 15; ctx.shadowColor = n.color;
            ctx.beginPath(); ctx.arc(n.x, n.y, 20, 0, Math.PI*2); ctx.fill();
            // í”Œë ˆì´ì–´ (ë‚˜ êµ¬ì²´)
            ctx.fillStyle = p.color; ctx.shadowColor = p.color;
            ctx.beginPath(); ctx.arc(p.x, p.y, 15, 0, Math.PI*2); ctx.fill();
            ctx.shadowBlur = 0;

            if(Math.hypot(p.x-n.x, p.y-n.y) < 40) {
                document.getElementById('game-wrapper').style.display = 'none';
                document.getElementById('ui-layer').style.display = 'block';
                return;
            }
            requestAnimationFrame(loop);
        }

        let selected = [];
        let limit = 0;

        function startTarot(count) {
            limit = count; selected = [];
            document.getElementById('ui-layer').style.display = 'none';
            document.getElementById('tarot-stage').style.display = 'block';
            const box = document.getElementById('cards-box');
            box.innerHTML = '';
            for(let i=0; i<count; i++) {
                box.innerHTML += `
                <div class="card" onclick="flip(this)">
                    <div class="card-inner">
                        <div class="card-face card-front">âœ¦</div>
                        <div class="card-face card-back"></div>
                    </div>
                </div>`;
            }
        }

        function flip(el) {
            if(el.classList.contains('flipped')) return;
            const data = tarotList[Math.floor(Math.random()*tarotList.length)];
            const isRev = Math.random() > 0.3;
            el.querySelector('.card-back').innerHTML = `<img src="${tarotBase}${data.i}" style="${isRev?'transform:rotate(180deg)':''}">`;
            el.classList.add('flipped');
            selected.push(data.n + (isRev?"(ì—­)":"(ì •)"));
            if(selected.length === limit) document.getElementById('ai-btn').style.display = 'block';
        }

        function interpret() {
            const res = document.getElementById('result-display');
            res.innerText = "ğŸ”® í•´ì„ ì¤‘... [" + selected.join(", ") + "]";
            document.getElementById('ai-btn').style.display = 'none';
        }

        loop();
    </script>
</body>
</html>
